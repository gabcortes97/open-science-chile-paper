---
author: LISA COES
editor: 
  markdown: 
    wrap: 72
---

```{r setup-chunk, include=FALSE}
knitr::opts_chunk$set(dev = 'png', dpi = 300, fig.width = 10, fig.height = 6,
                      message = FALSE, warning = FALSE, echo = FALSE, cache = TRUE)
#knitr::opts_knit$set(root.dir = "../3_output/img-cais-alas")
options(scipen=999)
options(knitr.kable.NA = '')
getwd()
```

```{r load-library, include=FALSE}
library(formr)
library(tidyverse)
library(writexl)
library(sjlabelled)
library(summarytools)
library(sjmisc)
library(summarytools)
library(ggrepel)
library(gridExtra)
```

```{r load-dataset, include=FALSE}
remove(list = ls())
load("input/data/cais.RData") #cargar datos local
```

```{r na-count, include=FALSE}
#names(lisa_cc)

lisa_v2_all <- cais %>% 
  rowwise() %>%
  mutate(n_NAs = sum(is.na(across(everything())))) #generamos una nueva variable que cuenta número de NA

lisa_v2_75 <- lisa_v2_all %>% 
  filter(n_NAs < 37) #N=40 -> 42 -> 70 -> 72

# lisa_v2_50 <- lisa_v2_all %>% 
#   filter(n_NAs < 72) #N=46 -> 48 -> 78 -> 80
# 
# lisa_v2_15 <- lisa_v2_all %>% 
#   filter(n_NAs < 108) #N=65 -> 69 -> 107 -> 112
```

```{r select-dataset, include=FALSE}

# lisa_v2_75 %>% mutate(edad= case_when(mod08_1>=28 & mod08_1<=34 ~ 1,
#                                   mod08_1>=35 & mod08_1<=49 ~ 2,
#                                   mod08_1>=50 ~ 3)) %>%
#   group_by(edad) %>% count()


cais_v2 <- lisa_v2_75 %>% 
  haven::zap_labels() %>% # eliminar las etiquetas de variables (haven_labelled) de una base de datos
  filter(mod01_6 > 1950) %>%  # filtrar datos de encuestas dudosas y de prueba
  mutate(edad0 = factor(car::recode(mod08_1, "28:34 = 1; 35:49 = 2; 50:80 = 3"), 
                        levels = c(1,2,3),
                        labels = c("28 a 34 años", "35 a 49 años", "50 o más años")),
         grado0 = factor(car::recode(mod01_5, "1=1; 2:3=2"),
                         levels= c(1,2),
                         labels= c("Magíster", "Doctorado")),
         etapa0 = factor(car::recode(mod01_1, "0:5 = 1; 6:15 = 2; 16:60 = 3"),
                         levels= c(1,2,3),
                         labels= c("Inicial (0 a 5 años)", "Intermedia (6 a 15 años)", "Avanzada (>15 años)")),
         enfoq0 = case_when(mod01_10 == 1 ~ 1, # cuali
                            mod01_10 == 2 ~ 2, # mixto  
                            mod01_10 %in% c(3,4) ~ 3, #cuanti
                            mod01_10 == 4 ~ NA_real_),
         mod08_2= factor(mod08_2,
                         levels= c(1,2),
                         labels=c("Mujer", "Hombre")),
         enfoq0= factor(enfoq0,
                        levels= c(1,2,3),
                        labels= c("Cualitativo", "Mixto", "Cuantitativo")),
         sexo = as_label(mod08_2),
         edad = as_label(edad0),
         grado = as_label(grado0),
         etapa = as_label(etapa0),
         enfoq = as_label(enfoq0))

  
legend = "Fuente CAIS (2024), N = 98"

cais_test_annos <- cais_v2 %>% 
  select(mod01_1, mod08_1)

frq(cais_v2$etapa)
frq(cais_v2$sexo)
frq(cais_v2$edad)
frq(cais_v2$enfoq)
frq(cais_v2$grado)
```

# Estudio Cuantitativo

## Método

Se diseñó un cuestionario a partir de la revisión de literatura
[@baker_500_2016; @delikoura_open_2021; @enke_user_2012;
@gross_landscapes_2015; @hail_reproducibility_2020;
@hodonu-wusu_malasyan_2020; @lacey_open_2020; @ljubenkovic_survey_2021;
@lopezcardenas_percepciones_2021; @knudtson_survey_2019;
@pardomartinez_knowledge_2018; @rodriguez_awareness_2014;
@rowley_academics_2017; @sturmer_earlycareer_2017;
@zhu_openaccess_2020], así como de los hallazgos de la etapa
cualitativa.

El cuestionario consistió en 91 preguntas divididas en los siguientes
módulos:

1)  **Ciencia Abierta**: 18 ítems relativos al conocimiento y la
    valoración general de los investigadores hacia la Ciencia Abierta

2)  **Diseño Transparente**: 20 ítems que abordan prácticas propias y
    percibidas en la comunidad sobre la transparencia en los diseños de
    investigación. Esto incluye tanto prácticas positivas (por ejemplo,
    *compartir códigos u otros materiales de investigación en un
    repositorio en línea de acceso público*) como negativas (por
    ejemplo, *creación post-hoc de hipótesis y explicaciones de datos*).

3)  **Datos abiertos**: 19 ítems relativos a prácticas, conocimiento y
    valoración del acceso abierto a los datos de investigación.

4)  **Investigación reproducible**: 15 ítems que indagan sobre
    conocimiento y valoración de la reproducibildiad de la investigación
    en Ciencias Sociales y la "crisis de reproducibilidad".

5)  **Acceso abierto a publicaciones**: 14 ítems que tratan sobre
    conocimiento, prácticas y valoración de la publicación de artículos
    en revistas Open Access.

6)  **Política de Acceso Abierto de la ANID**: 10 ítems sobre
    conocimiento y evaluación la Política de Acceso Abierto a la
    Información Científica y a Datos de Investigación de la Agencia
    Nacional de Investigación y Desarrollo de Chile (ANID).

El cuestionario fue aplicado mediante la plataforma FormR (Arslan et
al., 2020; Arslan, 2025). FormR es un software de código abierto que
permite diseñar cuestionarios complejos con un gran nivel de
personalización. Al estar integrado con RStudio (R+ RMarkdown), facilita
el trabajo colaborativo, independiente de la extensión del cuestionario.
La plataforma permite la autoaplicación del cuestionario, ya se mediante
una computadora o mediante teléfono celular.

Para construir la muestra, se enviaron correos de forma masiva a
investigadores que se hubieran ganado fondos de investigación estatales,
facultades y departamentos de distintas disciplinas de ciencias
sociales, así como centros y núcleos de investigación. Además, se
realizó difusión de la Encuesta mediante redes sociales y en eventos
académicos. Finalmente, se lograron 98 respuestas completas. La
descripción de la muestra obtenida se describe a continuación

> Agregar tabla

Se realizó un análisis descriptivo uni y bivariado de los indicadores
claves del cuestionario. El análisis se abocó a describir conocimientos,
prácticas y valoraciones de los encuestados en torno a la ciencia
abierta y los constructos descritos anteriormente. Estas variables
fueron cruzadas por grupo etario, enfoque de investigación, etapa en la
carrera académica, grado académico y género, con el fin de detectar
posibles diferencias entre grupos.

## Resultados

**Conocimientos**

Los niveles de familiaridad con conceptos relacionados a la ciencia
abierta refrendan lo observado en las entrevistas cualitativas, como se
observa en la @fig-cca. Así, el concepto más reconocido por los
encuestados es el de acceso abierto a publicaciones (79%), en línea con
lo descrito en la etapa anterior, donde la idea de apertura se
encontraba relacionada predominantemente a los resultados y
publicaciones de la investigación. Ideas como la apertura de datos
(59%), el uso de software libre para el análisis (53%), y el propio
concepto de ciencia abierta (46%) tienen niveles de conocimiento medio
entre los encuestados. En el otro extremo, sólo un 25% de los
encuestados mencionan estar familiarizados con el pre-registro de
hipótesis.

```{r labels-cca, echo=FALSE}

# El siguiente gráfico visualiza una batería, es decir, varios tems con preguntas diferentes, pero iguales valores de respuesta. Este tipo de gráficos sigue la siguiente estructura tipo:
labels_cca <- c("Concepto \nCiencia Abierta", 
                "Acceso abierto \npublicaciones", 
                "Preregistro \nde hipótesis", 
                "Apertura datos \ninvestigación", 
                "Investigación \nreproducible", "Repositorios \nabiertos", 
                "Software \nlibre análisis", "Acceso \nabierto datos")
```

```{r cca, echo=FALSE}
#| label: fig-cca
#| fig-cap: "Familiaridad Conceptos de Ciencia Abierta"
  
cais_v2 %>%
  # TRASPONER PARA QUE EL LA BATERÍA PASE A SER UNA VARIABLE EN SÍ MISMA
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  # RECODE PARA REDUCIR COMPLEJIDAD DE LOS VALORES
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  # CONTABILIZA EL CRUCE DE LA BATERÍA CON SUS RESPECTIVOS VALORES
  count(name, value) %>%
  # CREA NUEVA VARIABLE DE CON LA FRECUENCIA RELATIVA DE CADA VALOR RESPECTO A LA VARIABLE
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  # GGPLOT DE BARRAS 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = value, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  # ESPECIFICACIONES PARA EL TEXTO DE LAS BARRAS
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  # ESPECIFICACIONES PARA ETIQUETAS DE TÍTULOS, EJES Y LEYENDA (RELLENO)
  labs(
       caption = legend, x = "", y = "", fill = "") + 
  # ESPECIFICACIONES PARA POSICIÓN DE LA LEYENDA (FILL)
  theme(legend.position = 'none') +
  # ESPECIFICACIÓN DE PALETA DE COLORES
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  # AJUSTE DE LA ESCALA DEL EJE Y (PASA A PORCENTAJE)
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  # AJUSTE DE ORDEN DE LEYENDA (FILL)
  guides(fill = guide_legend(reverse = TRUE)) +
  # AJUSTE DE VISUALIZACIÓN PARA ROTAR LAS COORDENADAS
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none")
```

En general, los niveles de conocimiento parecen ser mayores entre
investigadores jóvenes y con enfoque predominantemente cuantitativo,
como se expone en la @fig-cca-grid. Los encuestados entre 28 y 34 años,
así, muestran mayores niveles de conocimiento sobre softwares libres, y
los conceptos de investigación reproducible y ciencia abierta
(@fig-cca-grid-1). Con todo, los investigadores entre 35 y 49 años
muestran mayores niveles de conocimiento de los preregistro de hipótesis
y del acceso abierto a datos. Los investigadores cuantitativos, en
tanto, presentan mayores niveles de conocimiento de todos los conceptos,
salvo en el acceso abierto a publicaciones (@fig-cca-grid-2).

```{r 1-cca-sexo, echo=FALSE, include=F}
# cais_v2 %>%
#   pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
#   mutate(name = factor(name, labels = labels_cca),
#          value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
#                         labels = c("Baja", "Media", "Alta"))) %>%
#   count(name, sexo, value) %>%
#   group_by(name, sexo) %>%
#   mutate(freq = n/sum(n)) %>%
#   filter(value == "Alta") %>%
#   ggplot(aes(x = reorder(name, freq), y = freq, fill = sexo,
#              label = scales::percent(freq, accuracy = .1))) +
#   geom_col(position = 'dodge2') +
#   geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
#   labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad",
#        caption = legend, x = "", y = "", fill = "Sexo/género") +
#   theme(legend.position = 'right') +
#   scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
#   scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
#   guides(fill = guide_legend(reverse = TRUE)) +
#   coord_flip()
```

```{r 1-cca-edad, echo=FALSE}
#| label: fig-cca-grid
#| fig-cap: "Familiaridad conceptos ciencia abierta por edad y enfoque de investigación" 
#| fig-subcap:
#|   - "Familiaridad conceptos ciencia abierta por edad"
#|   - "Familiaridad conceptos ciencia abierta por enfoque" 
#| layout-ncol: 1

cais_v2 %>% 
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, edad, value) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)*100) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = freq, y = reorder(name, freq), color = edad)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, enfoq, value) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)*100) %>%
  filter(value == "Alta") %>% 
  drop_na() %>% 
  ggplot(aes(x = freq, y = reorder(name, freq), color = enfoq)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

 
```

```{r 1-cca-etapa, echo=FALSE, include=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>%
  count(name, etapa, value) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>%
  ggplot(aes(x = reorder(name, freq), y = freq, fill = etapa,
             label = scales::percent(freq, accuracy = .1))) +
  geom_col(position = 'dodge2') +
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad",
       caption = legend, x = "", y = "", fill = "Etapa de la carrera\nacadémica") +
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 1-cca-grado, echo=FALSE, include=F}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>%
  count(name, grado, value) %>%
  group_by(name, grado) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>%
  ggplot(aes(x = reorder(name, freq), y = freq, fill = grado,
             label = scales::percent(freq, accuracy = .1))) +
  geom_col(position = 'dodge2') +
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcentaje con alta familiaridad",
       caption = legend, x = "", y = "", fill = "Grádo académico") +
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

En la misma línea, La Política de Acceso Abierto a la Información
Científica y a Datos de Investigación muestra niveles de conocimiento de
intermedios a bajo. En concreto, solo la mitad de los encuestado han
escuchado hablar sobre la política de acceso abierto de la ANID. Por
otro lado, solo un 26% conoce el plan de gestión de datos de la política
de acceso abierto de la ANID.

```{r anid-conocimiento, include=FALSE}
ANID <- lisa_v2_75 %>% # CONODIMIENTO DE ANID
  select(mod01_10, mod08_2, mod08_1, mod07_4, mod07_5) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Si", 
                      if_else(. == 2, "No", 
                              if_else(. == 3, "No se", NA_character_))))

frq(ANID$mod07_5) # CONOCE EL PLAN DE GESTION DE DATOS DE LA POLITICA DE ACCESO ABIERTO ANID?

ANID6 <- cais %>% 
  select(mod01_10, mod08_2, mod08_1, mod07_1) %>%
  mutate(
    mod07_1 = case_when(
      mod07_1 == 1 ~ "Sí",
      mod07_1 == 2 ~ "No",
      mod07_1 == 3 ~ "No sé",
      TRUE ~ NA_character_ ))

frq(ANID6$mod07_1)   # HA ESCUCHADO SOBRE LA POLITICA DE ACCESO ABIERTO DE ANID?


# GRAFICAR

```

**Prácticas**

a)  Práctica propias y prácticas de la comunidad

En general, se observa una baja frecuencia de prácticas relacionadas con
la ciencia abierta, como se aprecia en @fig-prac. Un 32% de los
encuestados siempre o casi siempre utiliza repositorios en línea para
subir información relacionada a sus investigaciones, y un 16% declara
compartir códigos entre investigadores (@fig-prac-2). Este tipo de
prácticas son más comunes entre investigadores hombres, aquellos cuyo
enfoque predominante es cuantitativo, y quienes están en una etapa
inicial de su carrera académica.

```{r 3-prac, echo=FALSE}
#| label: fig-prac
#| fig-cap: "¿Con qué frecuencias se realizan las siguientes prácticas?" 
#| fig-subcap:
#|   - "Prácticas de la Comunidad"
#|   - "Prácticas propias" 
#| layout-ncol: 1

labels_comu <- c("Compartir códigos entre\ninvestigadores/as",
                 "Utilizar repositorios abiertos en línea\npara subir información relacionada con\nlas investigaciones",
                 "Reporte selectivo de resultados, es decir,\nsolo aquello que va en concordancia\ncon las hipótesis",
                 "No informar estudios o variables que no\nalcanzaron significación estadística o\nalgún otro umbral estadístico deseado",
                 "Manipular datos para validar\nlas hipótesis")

labels_prop <- c("Compartir códigos entre\ninvestigadores/as",
                 "Utilizar repositorios abiertos en línea\npara subir información relacionada con\nlas investigaciones",
                 "Reporte selectivo de resultados, es decir,\nsolo aquello que va en concordancia\ncon las hipótesis",
                 "No informar estudios o variables que no\nalcanzaron significación estadística o\nalgún otro umbral estadístico deseado")

pr_comu <- cais_v2 %>%  
  select(starts_with("mod03_1_")) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Prácticas de la comunidad"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop <- cais_v2 %>% 
  select(starts_with("mod03_2_")) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Prácticas propias"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

pr_comu %>%
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  count(name, value, var) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Casi siempre o siempre") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(subtitle = "Porcentaje que responde 'Casi siempre o siempre'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none")

pr_prop %>%
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  count(name, value, var) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Casi siempre o siempre") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(subtitle = "Porcentaje que responde 'Casi siempre o siempre'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none")
```

Es interesante que, en general, los investigadores declaran mejores
prácticas propias que las percibidas en la comunidad. De tal modo, sólo
un 14% cree que siempre o casi siempre la comunidad utiliza repositorios
en línea para subir información relacionada a sus investigaciones, y un
5% cree que los investigadores comparten códigos con esa frecuencia
(@fig-prac-1).

Esta brecha es cierta también en lo relativo a las malas prácticas. Un
9% de los encuestados declara que casi siempre o siempre no informa
estudios o variables que no alcanzaron significación estadística,
mientras que un 45% percibe esta práctica como frecuente en la
comunidad. Por otro lado, mientras un 7% declara reportar selectivamente
resultados, el 40% cree que esto ocurre siempre o casi siempre entre la
comunidad. Finalmente, mientras nadie reconoce manipular datos para
validar una hipótesis, el 4% afirma que esto ocurre siempre o casi
siempre en la comunidad.

Es curioso que al desagregar el análisis en distintos grupos, se repiten
ciertas tendencias: Los investigadores hombres, de enfoque cuantitativo
y de carrera inicial son, al mismo tiempo, quienes reconocen mayor
frecuencia de prácticas propias, tanto negativas como positivas, como
quienes perciben la mayor cantidad de prácticas negativas en la
comunidad. Estas diferencias se pueden ver en detalle en @fig-prac-grid

```{r prac-grid, echo= F}
#| label: fig-prac-grid
#| fig-cap: "¿Con qué frecuencias se realizan las siguientes prácticas?" 
#| fig-subcap:
#|   - "Por sexo"
#|   - "Por etapa en la carrera académica" 
#|   - "Por enfoque de investigación"
#| layout-ncol: 1

# Gráfico Sexo
pr_comu_sexo <- cais_v2 %>%  
  select(starts_with("mod03_1_"), sexo) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Prácticas de la comunidad"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop_sexo <- cais_v2 %>% 
  select(starts_with("mod03_2_"), sexo) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Prácticas propias"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_sexo <- rbind(pr_comu_sexo, pr_prop_sexo) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Prácticas de la comunidad", "Prácticas propias"))) %>% 
  count(name, value, var, sexo) %>%
  group_by(name, var, sexo) %>%
  mutate(freq = n/sum(n)*100)

practicas_sexo %>% 
  filter(value == "Casi siempre o siempre") %>% 
    ggplot(aes(x = freq, y = reorder(name, freq), color = sexo)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  facet_wrap(~ var)

# Gráfico Etapa

pr_comu_etapa <- cais_v2 %>%  
  select(starts_with("mod03_1_"), etapa) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Prácticas de la comunidad"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop_etapa <- cais_v2 %>% 
  select(starts_with("mod03_2_"), etapa) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Prácticas propias"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_etapa <- rbind(pr_comu_etapa, pr_prop_etapa) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Prácticas de la comunidad", "Prácticas propias"))) %>% 
  count(name, value, var, etapa) %>%
  group_by(name, var, etapa) %>%
  mutate(freq = n/sum(n)*100)

practicas_etapa %>% 
  filter(value == "Casi siempre o siempre") %>% 
      ggplot(aes(x = freq, y = reorder(name, freq), color = etapa)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  facet_wrap(~ var)

# Gráfico enfoque

pr_comu_enfoq <- cais_v2 %>%
  filter(!is.na(enfoq)) %>%
  select(starts_with("mod03_1_"), enfoq) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Prácticas de la comunidad"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop_enfoq <- cais_v2 %>%
  filter(!is.na(enfoq)) %>%
  select(starts_with("mod03_2_"), enfoq) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Prácticas propias"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_enfoq <- rbind(pr_comu_enfoq, pr_prop_enfoq) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Prácticas de la comunidad", "Prácticas propias"))) %>% 
  count(name, value, var, enfoq) %>%
  group_by(name, var, enfoq) %>%
  mutate(freq = n/sum(n)*100)

practicas_enfoq %>% 
  filter(value == "Casi siempre o siempre") %>% 
        ggplot(aes(x = freq, y = reorder(name, freq), color = enfoq)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  facet_wrap(~ var)

```

b)  Barreras para la Ciencia Abierta

Por otro lado, se observa una alta percepción de barreras para el
desarrollo de la ciencia abierta en todas sus dimensiones. La Falta de
políticas es reconocida como la principal barrera en todas las
dimensiones, como se puede apreciar en la @fig-barreras. La falta de
conocimientos también aparece como una barrera importante,
particularmente para el diseño transparente, la apertura de datos y la
investigación reproducible. Por último, la falta de incentivos es
reconocida como otro aspecto que dificultan la apertura de datos.

```{r 4-bca-comp, echo=FALSE}
#| label: fig-barreras
#| fig-cap: "¿En qué medida considera que los siguientes factores limitan la Ciencia Abierta?"

var_label_barreras <- c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas")

disen <- cais_v2 %>%  
  select(starts_with("mod03_3_")) %>% pivot_longer(cols = starts_with("mod03_3_")) %>% 
  tibble(var = c(rep("Diseño transparente"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

datos <- cais_v2 %>% 
  select(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5) %>%  pivot_longer(cols = c(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5)) %>% 
  tibble(var = c(rep("Apertura de datos"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

repro <- cais_v2 %>% 
  select(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5) %>% pivot_longer(cols = c(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5)) %>% 
  tibble(var = c(rep("Investigación reproducible"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

publi <- cais_v2 %>% 
  select(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5) %>% pivot_longer(cols = c(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5)) %>% 
  tibble(var = c(rep("Publicaciones libres"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

barreras <- rbind(disen, datos, repro, publi) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nada o un poco", "Moderadamente", "Bastante o mucho"))) %>%
  mutate(var = factor(var, levels = c("Diseño transparente", "Apertura de datos", "Investigación reproducible", "Publicaciones libres"))) %>% 
  count(name, value, var) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n))

barreras %>% 
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(~ var) +
  theme_minimal() +
  theme(legend.position = "none")
```

Respecto a este último punto, se abordaron los incentivos que podrían
tener los investigadores para abrir sus datos. Como se aprecia en la
@fig-motivaciones, tanto generar redes, como difundir a la comunidad
datos financiados con recursos públicos y aumentar la visibilidad propia
son altamente valoradas como incentivos para la apertura de datos.

```{r motivaciones apertura, echo=F}
#| label: fig-motivaciones
#| fig-cap: "Motivaciones apertura de datos"

# analisis otras variables.
# Motivaciones apertura de datos ----

labels_motiv <- c("Generar redes",
                  "Difundir resultados",
                  "Aumentar visibilidad")

cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_motiv),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
filter(value=="Alta motivación") %>%
ggplot(aes(x = reorder(name, freq), y = freq, fill = value, label = scales::percent(freq, accuracy = 0.1))) + 
  geom_col(position = 'dodge2') +
  geom_text(position = position_dodge(width = 0.9), size = 2.5, hjust = -0.1) +
  labs(caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +  
  scale_fill_viridis_d(option = "magma", begin = 0.1, end = 0.7, direction = -1) + 
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal()+
  theme(legend.position = "none")
```

Es interesante constatar que, como se ve en la @fig-motivaciones-grid,
difundir resultados es valorado transversalmente, hay grupos donde la
valoración de motivaciones "egoístas" (siguiendo esta idea introducida
en el estudio cualitativo) tienen una mayor preponderancia.
Particularmente, el generar redes y aumentar la visibilidad son
incentivos más valorados por mujeres (@fig-motivaciones-grid-1) e
investigadores de entre 35 y 49 años (@fig-motivaciones-grid-2).

```{r motivaciones-grid}
#| label: fig-motivaciones-grid
#| fig-cap: "Motivaciones apertura de datos"
#| fig-subcap:
#|   - "Por sexo"
#|   - "Por edad" 
#| layout-ncol: 1


cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_motiv),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, sexo) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)*100) %>% 
  filter(value=="Alta motivación") %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = sexo)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_motiv),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, edad) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)*100) %>% 
  filter(value=="Alta motivación") %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = edad)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)
  
```

```{r 4-bca-sexo, echo=FALSE, warning=FALSE, include=F}

var_label_barreras <- c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas")

disen <- cais_v2 %>%  
  select(starts_with("mod03_3_"), sexo) %>% pivot_longer(cols = starts_with("mod03_3_")) %>% 
  tibble(var = c(rep("Diseño transparente"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

datos <- cais_v2 %>% 
  select(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5, sexo) %>%  pivot_longer(cols = c(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5)) %>% 
  tibble(var = c(rep("Apertura de datos"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

repro <- cais_v2 %>% 
  select(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5, sexo) %>% pivot_longer(cols = c(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5)) %>% 
  tibble(var = c(rep("Investigación reproducible"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

publi <- cais_v2 %>% 
  select(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5, sexo) %>% pivot_longer(cols = c(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5)) %>% 
  tibble(var = c(rep("Publicaciones libres"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

barreras <- rbind(disen, datos, repro, publi) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nada o un poco", "Moderadamente", "Bastante o mucho"))) %>%
  mutate(var = factor(var, levels = c("Diseño transparente", "Apertura de datos", "Investigación reproducible", "Publicaciones libres"))) %>% 
  count(name, value, var, sexo) %>%
  group_by(name, var, sexo) %>%
  mutate(freq = n/sum(n))

barreras %>% 
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, sexo), y = freq, fill = sexo,
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿En qué medida considera que los siguientes factores limitan la CA?',  
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(~ var)



var_label_barreras <- c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas")

disen <- cais_v2 %>%  
  select(starts_with("mod03_3_"), enfoq) %>% pivot_longer(cols = starts_with("mod03_3_")) %>% 
  tibble(var = c(rep("Diseño transparente"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

datos <- cais_v2 %>% 
  select(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5, enfoq) %>%  pivot_longer(cols = c(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5)) %>% 
  tibble(var = c(rep("Apertura de datos"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

repro <- cais_v2 %>% 
  select(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5, enfoq) %>% pivot_longer(cols = c(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5)) %>% 
  tibble(var = c(rep("Investigación reproducible"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

publi <- cais_v2 %>% 
  select(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5, enfoq) %>% pivot_longer(cols = c(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5)) %>% 
  tibble(var = c(rep("Publicaciones libres"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

barreras <- rbind(disen, datos, repro, publi) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nada o un poco", "Moderadamente", "Bastante o mucho"))) %>%
  mutate(var = factor(var, levels = c("Diseño transparente", "Apertura de datos", "Investigación reproducible", "Publicaciones libres"))) %>% 
  count(name, value, var, enfoq) %>%
  group_by(name, var, enfoq) %>%
  mutate(freq = n/sum(n))

barreras %>% 
  filter(value == "Bastante o mucho" & !is.na(enfoq)) %>% 
  ggplot(aes(x = reorder(name, enfoq), y = freq, fill = enfoq,
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿En qué medida considera que los siguientes factores limitan la CA?',  
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(~ var)
```

```{r bca-all, eval=FALSE, include=FALSE}
disen2 <- cais_v2 %>% select(starts_with("mod03_3_")) %>% pivot_longer(cols = starts_with("mod03_3_")) %>% 
  tibble(var = c(rep("Diseño\ntransparente"))) %>% 
  mutate(name = factor(name, labels = c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas")))

datos2 <- cais_v2 %>% select(starts_with("mod04_3_")) %>% pivot_longer(cols = starts_with("mod04_3_")) %>% 
  tibble(var = c(rep("Apertura\nde datos"))) %>% 
  mutate(name = factor(name, labels = c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas",
                                        "Temor al cuestionamiento", "Preocupación por datos sensibles")))

repro2 <- cais_v2 %>% select(starts_with("mod05_6_")) %>% pivot_longer(cols = starts_with("mod05_6_")) %>% 
  tibble(var = c(rep("Investigación\nreproducible"))) %>% 
  mutate(name = factor(name, labels = c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas",
                                        "Temor al cuestionamiento")))

publi2 <- cais_v2 %>% select(starts_with("mod06_6_")) %>% pivot_longer(cols = starts_with("mod06_6_")) %>% 
  tibble(var = c(rep("Acceso abierto\na publicaciones"))) %>% 
  mutate(name = factor(name, labels = c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas",
                                        "Restricciones de pago", "Falta de recursos financieros", "La falta de plataformas", "Derechos de autor")))

barreras2 <- rbind(disen2, datos2, repro2, publi2) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nada o un poco", "Moderadamente", "Bastante o mucho"))) %>%
  mutate(var = factor(var, levels = c("Diseño\ntransparente", "Apertura\nde datos", "Investigación\nreproducible", "Acceso abierto\na publicaciones"))) %>% 
  count(name, value, var) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n))

barreras2 %>% 
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = fct_rev(name), y = freq, fill = fct_rev(var),
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2, hjust = -.1) +
  labs(title = 'Nivel de familiaridad de los siguientes conceptos',  subtitle = "", x = "", y = "", fill = "") + 
  theme(legend.position = 'top') +
  scale_fill_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(.~ var)
```

**Valoraciones**

a) Valoraciones sobre medidas de Ciencia Abierta

En general, se valora positivamente la posibilidad de adoptar medidas de
Ciencia Abierta en las Ciencias Sociales, como se puede observar en @fig-val . El acceso abierto (92%), la
replicación de hallazgos (67%), el reporte de resultados no
estadísticamente significativos (76%), y la disponibilización en línea
de datos y materiales de análisis (72%), todas muestran un alto nivel de
aceptación entre los encuestados. La única excepción es el pre-registro de hipótesis, que solo tiene un
42% de evaluación positiva. Esto se explica por un mayor nivel de
desconocimiento (17% dice no conocer la medida), además de las
reticencias observadas tanto en las entrevistas del estudio cualitativo. 

```{r 2-vca, echo=FALSE}
#| label: fig-val
#| fig-cap: "¿Qué tan necesarias cree que son las siguientes medidas impulsadas por la CA para la investigación en Ciencias Sociales?"

labels_valor <- c("Pre-registro de hipótesis", 
                  "Disponibilizar en linea\nlos datos, materiales y\nprotocolos de análisis", 
                  "Reportar resultados aunque\nestos no sean estadísticamente\nsignificativos",
                  "Replicar y examinar los\nhallazgos publicados",
                  "Tomar medidas para que\nlas publicaciones sean\nde acceso abierto")
  
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
  ggplot(aes(x = name, y = freq, fill = factor(value, levels = c("No la conoce", "Nada o poco", "Moderadamente", "Bastante o mucho")), 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'Stack') + 
  geom_text(position = position_stack(vjust = .5), size= 2.5, color = 'white') +
  labs(caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "bottom")
```

Salvo por el acceso abierto a publicaciones, que es valorada transversalmente por todos los grupos, estas medidas son apoyadas en mayor medida por investigadoras mujeres y por investigadores con enfoque cuantitativo. 

```{r 2-vca-sexo, echo=FALSE}
#| label: fig-vca-grid
#| fig-cap: "¿Qué tan necesarias cree que son las siguientes medidas impulsadas por la CA para la investigación en Ciencias Sociales?, por sexo y enfoque de investigación"
#| fig-subcap:
#|   - "Por sexo"
#|   - "Por enfoque" 
#| layout-ncol: 1


cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, sexo) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = sexo)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)


cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, enfoq) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho" & !is.na(enfoq)) %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = enfoq)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom") +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)
  
```

```{r 2-vca-edad, echo=FALSE, include=F}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, edad) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = edad, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Grupo etario") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1.1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-etapa, echo=FALSE, include=F}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, etapa) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = etapa, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Etapa de la carrera\nacadémica") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1.1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-grado, echo=FALSE, include=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, grado) %>%
  group_by(name, grado) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = grado, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Grado académico") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

b) Valoraciones sobre la Crisis de Reproducibilidad

El 39% de los encuestados cree que hay una crisis importante de reproducibilidad, mientras que el 40% no sabe si la hay. 

```{r crisis-reproducibilidad}
cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                            "Hay una ligera crisis de reproducibilidad",	
                                            "Hay una importante crisis de reproducibilidad",
                                            "No sé"),
                         levels= 1:4)) %>%
  group_by(mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n)) #Ambivalencia. Alto nivel de desconocimiento.

# GRAFICAR. QUIZÁS UN GRÁFICO DE DONA. 
```

Además, se identificaron diferencias respecto al enfoque de investigación. La preocupación es mayor entre los investigadores cuantitativos, ya que el 70% cree que la crisis es importante. Si bien entre los investigadores cualitativos no se llega a negar la crisis, si hay un 60% que desconoce si la hay o no. 

```{r crisis-enfoque}
cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                   "Hay una ligera crisis de reproducibilidad",	
                                   "Hay una importante crisis de reproducibilidad",
                                   "No sé"),
                         levels= 1:4)) %>%
  group_by(enfoq, mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n)) # Entre investigadores cuantiativos el 82% cree que la crisis es importe. Entre investigadores cuali, el 59% no sabe. 

# GRAFICAR. TRES GRAFICOS DE DONA, UNA POR ENFOQUE EN UN GRILLA?
```

Por otro lado, el 59% cree que el 30% o menos de las investigaciones en ciencias
sociales son reproducibles; El 83% cree que menos de la mitad de las
investigaciones en ciencias sociales son reproducibles.

```{r, percecpcion-repro, include=F}
cais_v2 %>% 
  group_by(mod05_4) %>%
  summarise(n= n()) %>%
  mutate(acum= cumsum(n/sum(n)))

# GRAFICAR. NO SÉ MUY BIEN CÓMO, ¿GRÁFICO DE LINEAS CON UNA LINEA VERTICAL INDICANDO ALGUNOS UMBRALES? ¿GRAFICO DE BARRAS? SI NO, FILO NO MÁS. 

```

Esto va en línea con que el 40% de los encuestado ha intentado reproducir resultados de otros investigadores. De este porcentaje, solo el 20% de los intentos han logrado una reproducción completa, mientras que el 69% ha logrado reproducciones parciales. 


```{r intentos-reprod, include=F}

labels_valor <- c("¿Ha intentado reproducir uno de sus propios resultados?",
                  "¿Ha intentado reproducir los resultados de alguien más?")

cais_v2 %>%
  pivot_longer(cols = c(mod05_5_1, mod05_5_3))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("Sí", "No", "No sé"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n))

# 58% ha intentado reproducir sus propios resultados y un 43% los resultados de otro investigador
```

```{r, include=F}
cais_v2 %>%
  pivot_longer(cols = c(mod05_5_2, mod05_5_4)) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("No logrado", "Logrado parcialmente", "Logrado"),
                        levels = 1:3)) %>%
  filter(!is.na(value) &
        name== "¿Ha intentado reproducir los resultados de alguien más?") %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) 

# GRAFICAR. GRAFICO DE DONA?
```

c) Valoraciones Política de Ciencia Abierta de la ANID

En primera instancia, la Política de Ciencia Abierta de la ANID encuentra buena acogida entre los encuestados. Así, el 90% considera que está de acuerdo o muy de acuerdo con que la ANID continúe desarrollando políticas de ciencia abierta. Asimismo, el 84% considera bastante o muy necesario la implementación de políticas de accesoa abierto.

Sin embargo, hay otras prácticas que encuentran una menor acogida. Así, tanto la obligatoriedad del prerregistro o de la reproducibilidad obtiene un apoyo del 50% de los encuestados. 

Por último, la política de difusión de la ANID es evaluada negativamente por la mayoría de los encuestados. Solo un 24% considera que estas política es buena o muy buena. 

```{r modulo-anid, include=FALSE}
ANID <- lisa_v2_75 %>% # CONODIMIENTO DE ANID
  select(mod01_10, mod08_2, mod08_1, mod07_4, mod07_5) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Si", 
                      if_else(. == 2, "No", 
                              if_else(. == 3, "No se", NA_character_))))


frq(ANID$mod07_4) # HA PUBLICADO ALGUN TRABAJO EN EL REPOSITORIO DE LA ANID?
frq(ANID$mod07_5) # CONOCE EL PLAN DE GESTION DE DATOS DE LA POLITICA DE ACCESO ABIERTO ANID?


ANID6 <- cais %>% 
  select(mod01_10, mod08_2, mod08_1, mod07_1) %>%
  mutate(
    mod07_1 = case_when(
      mod07_1 == 1 ~ "Sí",
      mod07_1 == 2 ~ "No",
      mod07_1 == 3 ~ "No sé",
      TRUE ~ NA_character_ ))

frq(ANID6$mod07_1)   # HA ESCUCHADO SOBRE LA POLITICA DE ACCESO ABIERTO DE ANID?


ANID2 <- lisa_v2_75 %>% select(mod01_10, mod08_2, mod08_1, mod07_2, mod07_8, mod07_9) %>% #QUE TAN NECESARIA ES LA CS ABIERTA EN ANID
  mutate_at(vars(starts_with("mod07")),
            ~ if_else(. == 1, "Nada", 
                      if_else(. == 2, "Ligeramente", 
                              if_else(. == 3, "Moderadamente",
                                      if_else(. == 4, "Bastante", 
                                              if_else(. == 5, "Muy", NA_character_))))))

frq(ANID2$mod07_2) #que tan necesario es la implementacion de politicas de accesoa bierto...
frq(ANID2$mod07_8) #QUE TAN NECESARIO ES QUE LA ANID INCORPRE EL PREREGISTRO?
frq(ANID2$mod07_9) # QUE TAN NECESARIO ES QUE INCORPORE LA REPRODUCIBILIDAD


ANID3 <- lisa_v2_75 %>% select(mod01_10, mod08_2, mod08_1, mod07_7) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Muy en desacuerdo", 
                      if_else(. == 2, "En desacuerdo", 
                              if_else(. == 3, "Ni de acuerdo ni en desacuerdo",
                                      if_else(. == 4, "De acuerdo",
                                              if_else(. == 5, "Muy de acuerdo", NA_character_))))))
frq(ANID3$mod07_7) # QUE TAN DE ACUERDO CON QUE ANID DESARROLLE E IMPLEMENTE POLITICAS DE CS ABIERTA

ANID4 <- lisa_v2_75 %>% select(mod01_10, mod08_2, mod08_1, mod07_10) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Mala", 
                      if_else(. == 2, "Regular", 
                              if_else(. == 3, "Neutra",
                                      if_else(. == 4, "Buena",
                                              if_else(. == 5, "Muy Buena", NA_character_))))))# CALIDAD DE LA DIFUSION DE ACCESO ABIERTO A ANID
frq(ANID4$mod07_10) # COMO EVALUA LA DIFUSION DE LA POLITICA DE ACCESO ABIERTO DE ANID

ANID5 <- cais %>% select (mod01_10, mod08_2, mod08_1, mod07_3)

frq(ANID5$mod07_3)# QUE TAN FAMILIARIZADO ESTA CON EL REPOSITORIO ABIERTO DE ANID.

```
