---
author: LISA COES
editor: 
  markdown: 
    wrap: 72
---

```{r setup-chunk, include=FALSE} 
knitr::opts_chunk$set(dev = 'png', dpi = 300, fig.width = 10, fig.height = 6,
                      message = FALSE, warning = FALSE, echo = FALSE, cache = TRUE)
#knitr::opts_knit$set(root.dir = "../3_output/img-cais-alas")
options(scipen=999)
options(knitr.kable.NA = '')
getwd()
```
```{r load-library, include=FALSE}
library(formr)
library(tidyverse)
library(writexl)
library(sjlabelled)
library(summarytools)
library(sjmisc)
```

```{r load-dataset, include=FALSE}
remove(list = ls())
load("~/GitHub/paper-mixed-methods/input/data/cais.RData") #cargar datos local
```

```{r na-count, include=FALSE}
#names(lisa_cc)

lisa_v2_all <- cais %>% 
  rowwise() %>%
  mutate(n_NAs = sum(is.na(across(everything())))) #generamos una nueva variable que cuenta número de NA

lisa_v2_75 <- lisa_v2_all %>% 
  filter(n_NAs < 37) #N=40 -> 42 -> 70 -> 72

lisa_v2_50 <- lisa_v2_all %>% 
  filter(n_NAs < 72) #N=46 -> 48 -> 78 -> 80

lisa_v2_15 <- lisa_v2_all %>% 
  filter(n_NAs < 108) #N=65 -> 69 -> 107 -> 112
```

```{r select-dataset, include=FALSE}
cais_v2 <- lisa_v2_75 %>% 
  haven::zap_labels() %>% # eliminar las etiquetas de variables (haven_labelled) de una base de datos
  filter(mod01_6 > 1950) %>%  # filtrar datos de encuestas dudosas y de prueba
  mutate(edad0 = factor(car::recode(mod08_1, "28:34 = 1; 35:49 = 2; 50:80 = 3")),
         grado0 = factor(car::recode(mod01_5, "1=1; 2:3=2")),
         etapa0 = factor(car::recode(mod01_1, "0:5 = 1; 6:15 = 2; 16:60 = 3")),
         enfoq0 = case_when(mod01_10 == 1 ~ 1, # cuali
                            mod01_10 == 2 ~ 2, # mixto  
                            mod01_10 %in% c(3,4) ~ 3, #cuanti
                            mod01_10 == 4 ~ NA_real_)) %>% # otra a NA 
  set_labels(mod08_2, labels = c("Mujer", "Hombre")) %>%
  set_labels(edad0, labels = c("28 a 34 años", "35 a 49 años", "50 o más años")) %>% 
  set_labels(grado0, labels = c("Magíster", "Doctorado")) %>%
  set_labels(etapa0, labels = c("Inicial (0 a 5 años)", "Intermedia (6 a 15 años)", "Avanzada (>15 años)")) %>% 
  set_labels(enfoq0, labels = c("Cualitativo", "Mixto", "Cuantitativo")) %>% 
  mutate(sexo = as_label(mod08_2),
         edad = as_label(edad0),
         grado = as_label(grado0),
         etapa = as_label(etapa0),
         enfoq = as_label(enfoq0))
  
legend = "Fuente CAIS (2024), N = 98"

cais_test_annos <- cais_v2 %>% 
  select(mod01_1, mod08_1)

frq(cais_v2$etapa)
```

```{r setup-chunk, include=FALSE}
ANID <- lisa_v2_75 %>% # CONODIMIENTO DE ANID
  select(mod01_10, mod08_2, mod08_1, mod07_1, mod07_4, mod07_5) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Si", 
                      if_else(. == 2, "No", 
                              if_else(. == 3, "No se", NA_character_))))

frq(ANID$mod07_1) # HA ESCUCHADO SOBRE LA POLITICA DE ACCESO ABIERTO DE ANID?
frq(ANID$mod07_4) # HA PUBLICADO ALGUN TRABAJO EN EL REPOSITORIO DE LA ANID?
frq(ANID$mod07_5) # CONOCE EL PLAN DE GESTION DE DATOS DE LA POLITICA DE ACCESO ABIERTO ANID?





ANID2 <- lisa_v2_75 %>% select(mod01_10, mod08_2, mod08_1, mod07_2, mod07_8, mod07_9) %>% #QUE TAN NECESARIA ES LA CS ABIERTA EN ANID
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Nada", 
                      if_else(. == 2, "Ligeramente", 
                              if_else(. == 3, "Moderadamente",
                                      if_else(. == 4, "Bastante", 
                                              if_else(. == 5, "Muy", NA_character_))))))

frq(ANID2$mod07_2) #que tan necesario es la implementacion de politicas de accesoa bierto...
frq(ANID2$mod07_8) #QUE TAN NECESARIO ES QUE LA ANID INCORPRE EL PREREGISTRO?
frq(ANID2$mod07_9) # QUE TAN NECESARIO ES QUE INCORPORE LA REPRODUCIBILIDAD


ANID3 <- lisa_v2_75 %>% select(mod01_10, mod08_2, mod08_1, mod07_7) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Muy en desacuerdo", 
                      if_else(. == 2, "En desacuerdo", 
                              if_else(. == 3, "Ni de acuerdo ni en desacuerdo",
                                      if_else(. == 4, "De acuerdo",
                                              if_else(. == 5, "Muy de acuerdo", NA_character_))))))
frq(ANID3$mod07_7) # QUE TAN DE ACUERDO CON QUE ANID DESARROLLE E IMPLEMENTE POLITICAS DE CS ABIERTA

ANID4 <- lisa_v2_75 %>% select(mod01_10, mod08_2, mod08_1, mod07_10) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Mala", 
                      if_else(. == 2, "Regular", 
                              if_else(. == 3, "Neutra",
                                      if_else(. == 4, "Buena",
                                              if_else(. == 5, "Muye Buena", NA_character_))))))# CALIDAD DE LA DIFUSION DE ACCESO ABIERTO A ANID
frq(ANID4$mod07_10) # COMO EVALUA LA DIFUSION DE LA POLITICA DE ACCESO ABIERTO DE ANID

ANID5 <- cais %>% select (mod01_10, mod08_2, mod08_1, mod07_3)

frq(ANID5$mod07_3)# QUE TAN FAMILIARIZADO ESTA CON EL REPOSITORIO ABIERTO DE ANID.

```

```{r setup-chunk, include=FALSE}
# Motivaciones apertura de datos ----

labels_valor <- c("Generar redes con otros/as científicos/as para estudios interdisciplinarios",
                  "Difundir a la comunidad los resultados de una investigación financiada con recursos públicos",
                  "Aumentar mi visibilidad en la comunidad científica")

motivaciones_data <- cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>% print()

#GRAFICO

ggplot(motivaciones_data, aes(x = reorder(name, freq), y = freq, fill = value, label = scales::percent(freq, accuracy = 0.1))) + 
  geom_col(position = 'dodge2') +  # Uso de geom_col() y posición dodge2 para barras agrupadas
  geom_text(position = position_dodge(width = 0.9), size = 2.5, hjust = -0.1) +  # Etiquetas de porcentaje en las barras
  facet_wrap(~ value) +  # Facetado por 'value'
  labs(title = 'Distribución de la Motivación por Categoría', 
       subtitle = "Porcentaje de cada categoría de motivación", 
       caption = "Fuente: Motivaciones Data", x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +  # Eliminar la leyenda
  scale_fill_viridis_d(option = "magma", begin = 0.1, end = 0.7, direction = -1) +  
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) + 
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()  



#----------------------------------------------

motivaciones_genero <- cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, sexo) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)) %>% print() # Generar redes parece motivar más a los hombres, mientras que aumentar la visibilidad a las mujeres


motivaciones_edad <- cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, edad) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)) %>% print()

motivaciones_etapa <- cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, etapa) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>% print()

motivaciones_enfoque <- cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(enfoq)) %>%
  count(name, value, enfoq) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)) %>% print()


# Crisis de reproducibilidad ----

cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                            "Hay una ligera crisis de reproducibilidad",	
                                            "Hay una importante crisis de reproducibilidad",
                                            "No sé"),
                         levels= 1:4)) %>%
  group_by(mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n)) #Ambivalencia. Alto nivel de desconocimiento. La mitad cree que la crisis es importante pero el 29% niega que exista

cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                   "Hay una ligera crisis de reproducibilidad",	
                                   "Hay una importante crisis de reproducibilidad",
                                   "No sé"),
                         levels= 1:4)) %>%
  group_by(sexo, mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n)) #El desconocimiento y la negación de la crisis es mayor entre mujeres

cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                   "Hay una ligera crisis de reproducibilidad",	
                                   "Hay una importante crisis de reproducibilidad",
                                   "No sé"),
                         levels= 1:4)) %>%
  group_by(edad, mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n))

cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                   "Hay una ligera crisis de reproducibilidad",	
                                   "Hay una importante crisis de reproducibilidad",
                                   "No sé"),
                         levels= 1:4)) %>%
  group_by(etapa, mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n))


cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("No hay crisis de reproducibilidad",
                                   "Hay una ligera crisis de reproducibilidad",	
                                   "Hay una importante crisis de reproducibilidad",
                                   "No sé"),
                         levels= 1:4)) %>%
  group_by(enfoq, mod05_3) %>% 
  summarise(n= n()) %>%
  mutate(freq = n / sum(n)) # Entre investigadores cuantiativos el 82% cree que la crisis es importe. Entre investigadores cuali, el 59% no sabe. 

summary(cais_v2$mod05_4)

cais_v2 %>% 
  group_by(mod05_4) %>%
  summarise(n= n()) %>%
  mutate(acum= cumsum(n/sum(n)))

# El 21% considera que menos del 10% de los trabajos publicados en ciencias sociales son replicables
# El 59% cree que menos del 30% de los trabajos publicados en ciencias sociale son replicables
# Eñ 83% considera que menos del 50% de los trabajos publicados en cienicas sociales son replicables

# Intento de reproducibilidad

labels_valor <- c("¿Ha intentado reproducir uno de sus propios resultados?",
                  "¿Ha intentado reproducir los resultados de alguien más?")

cais_v2 %>%
  pivot_longer(cols = c(mod05_5_1, mod05_5_3))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("Sí", "No", "No sé"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) 

# 58% ha intentado reproducir sus propios resultados y un 43% los resultados de otro investigador

cais_v2 %>%
  pivot_longer(cols = c(mod05_5_1, mod05_5_3))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("Sí", "No", "No sé"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, sexo) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) 

# Mayor entre hombres

cais_v2 %>%
  pivot_longer(cols = c(mod05_5_1, mod05_5_3))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("Sí", "No", "No sé"),
                        levels = 1:3)) %>%
  filter(!is.na(value) & !is.na(enfoq)) %>%
  count(name, value, enfoq) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) 

# Mayor entre cuantitativos 

cais_v2 %>%
  pivot_longer(cols = c(mod05_5_1, mod05_5_3))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("Sí", "No", "No sé"),
                        levels = 1:3)) %>%
  filter(!is.na(value) & !is.na(enfoq)) %>%
  count(name, value, etapa) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) 

# Mayor entre carreras avanzada

cais_v2 %>%
  pivot_longer(cols = c(mod05_5_2, mod05_5_4))  %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(value,
                        labels = c("No logrado", "Logrado parcialmente", "Logrado"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) 

# Un 51% de los intentos con resultados propios se han logrado reproducir completamente
# Solo un 19% de los intentetos con resultados de alguien mas se han logrado reproducir completamente. Un 69% logra reproducciones parciales. 

```


# Estudio Cuantitativo

## Método

Se diseñó un cuestionario a partir de la revisión de literatura (Baker,
2016; Chin et al., 2021; Delikoura & Kouis, 2021; Enke et al., 2012;
Gross & Ryan, 2015; Hail et al., 2020; Hodenu-wusu et al., 2020; Lacey
et al., 2020; Ljubenkovic et al., 2021; López-Cardenas &
Cubero-Castillo; 2021; Knudtson et al., 2019; Pardo Martínez & Poveda,
2018; Rodríguez, 2014; Rowley et al., 2017; Sturmer et al., 2017; Zhu,
2020 ), así como de los hallazgos de la etapa cualitativa.

El cuestionario consistió en 91 preguntas divididas en los siguientes
módulos:

1)  **Ciencia Abierta**: 18 ítems relativos al conocimiento y la
    valoración general de los investigadores hacia la Ciencia Abierta

2)  **Diseño Transparente**: 20 ítems que abordan prácticas propias y
    percibidas en la comunidad sobre la transparencia en los diseños de
    investigación. Esto incluye tanto prácticas positivas (por ejemplo,
    *compartir códigos u otros materiales de investigación en un
    repositorio en línea de acceso público*) como negativas (por
    ejemplo, *creación post-hoc de hipótesis y explicaciones de datos*).

3)  **Datos abiertos**: 19 ítems relativos a prácticas, conocimiento y
    valoración del acceso abierto a los datos de investigación.

4)  **Investigación reproducible**: 15 ítems que indagan sobre
    conocimiento y valoración de la reproducibildiad de la investigación
    en Ciencias Sociales y la "crisis de reproducibilidad".

5)  **Acceso abierto a publicaciones**: 14 ítems que tratan sobre
    conocimiento, prácticas y valoración de la publicación de artículos
    en revistas Open Access.

El cuestionario fue aplicado mediante la plataforma FormR (Arslan et
al., 2020; Arslan, 2025). FormR es un software de código abierto que
permite diseñar cuestionarios complejos con un gran nivel de
personalización. Al estar integrado con RStudio (R+ RMarkdown), facilita
el trabajo colaborativo, independiente de la extensión del cuestionario.
La plataforma permite la autoaplicación del cuestionario, ya se mediante
una computadora o mediante teléfono celular.

> Preguntar por muestreo

Se lograron 98 respuestas completas. La descripción de la muestra
obtenida se describe a continuación

> Agregar tabla

Se realizó un análisis descriptivo uni y bivariado de los indicadores
claves del cuestionario. El análisis se abocó a describir conocimientos,
prácticas y valoraciones de los encuestados en torno a la ciencia
abierta y los constructos descritos anteriormente. Estas variables
fueron cruzadas por grupo etario, enfoque de investigación, etapa en la
carrera académica, grado académico y género, con el fin de detectar
posibles diferencias entre grupos.

> Modelar o no modelar?

## Resultados

Conocimientos

Los niveles de familiaridad con conceptos relacionados a la ciencia
abierta refrendan lo observado en las entrevistas cualitativas. Así, el
concepto más reconocido por los encuestados es el de acceso abierto a
publicaciones, en línea con lo descrito en la etapa anterior, donde la
idea de apertura se encontraba relacionada predominantemente a los
resultados y publicaciones de la investigación. En el otro extremo, sólo
un 33% de los encuestados mencionan estar familiarizados con el
pre-registro de hipótesis. En general, los niveles de conocimiento
parecen ser mayores entre investigadores jóvenes y con enfoque
predominantemente cuantitativo.

```{}
```

Prácticas

En general, se observa una baja frecuencia de prácticas relacionadas con
la ciencia abierta. Un 37% de los encuestados siempre o casi siempre
utiliza repositorios en línea para subir información relacionada a sus
investigaciones, y un 21% declara compartir códigos entre
investigadores. Este tipo de prácticas son más comunes entre
investigadores hombres, aquellos cuyo enfoque predominante es
cuantitativo, y quienes están en una etapa inicial o intermedia de su
carrera académica.

```{r 1-cca-sexo, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, sexo, value) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = sexo, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "Sexo/género") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

Es interesante que, en general, los investigadores declaran mejores
prácticas propias que las percibidas en la comunidad. De tal modo, sólo
un 16% cree que siempre o casi siempre la comunidad utiliza repositorios
en línea para subir información relacionada a sus investigaciones, y un
6% cree que los investigadores comparten códigos con esa frecuencia.

Esta brecha es cierta también en lo relativo a las malas prácticas. Un
10% de los encuestados declara que casi siempre o siempre no informa
estudios o variables que no alcanzaron significación estadística,
mientras que un 51% percibe esta práctica como frecuente en la
comunidad. Por otro lado, mientras un 6% declara reportar selectivamente
resultados, el 47% cree que esto ocurre siempre o casi siempre entre la
comunidad. Finalmente, mientras nadie reconoce manipular datos para
validar una hipótesis, el 6% afirma que esto ocurre siempre o casi
siempre en la comunidad.

En general, la percepción de prácticas negativas en la comunidad es
superior entre hombres que entre mujeres. Un 66% de los investigadores
hombres cree que en la comunidad casi siempre o siempre no se informan
resultados que no alcanzaron la significación estadística y un 59% cree
que el reporte selectivo de resultado es una práctica frecuente en la
comunidad. Esto puede estar relacionado a que los investigadores
hombres, además, reconocen llevar a cabo estas prácticas con mayor
frecuencia.

Por otro lado, se observa una alta percepción de barreras para el
desarrollo de la ciencia abierta en todas sus dimensiones. La falta de
políticas y la falta de incentivos son reconocidos como los principales
factores que limitan a la ciencia abierta. En menor medida, pero también
relevante, se reconoce la falta de conocimiento como una dificultad para
el diseño transparente. La reticencia ante el plagio, además, es una de
las principales razones que restringen la apertura de datos.

Valoraciones

En general, se valora positivamente la posibilidad de adoptar medidas de
Ciencia Abierta en las Ciencias Sociales. El acceso abierto (90%), la
replicación de hallazgos (74%), el reporte de resultados no
estadísticamente significativos (81%), y la disponibilización en línea
de datos y materiales de análisis (81%), todas muestran un alto nivel de
aceptación entre los encuestados.

La única excepción es el pre-registro de hipótesis, que solo tiene un
49% de evaluación positiva. Esto se explica por un mayor nivel de
desconocimiento (17% dice no conocer la medida), además de las
reticencias observadas tanto en las entrevistas como en el apartado
anterior.

Salvo por el acceso abierto a publicaciones, la valoración positiva de
estas medidas es mayor entre investigadores con enfoque cuantitativo
(menor entre investigadores cualitativos e intermedio entre quienes
practican enfoques mixtos), en la etapa inicial (hasta 5 años) o
intermedia (de 6 a 15 años) de su carrera académica, y entre mujeres.

Otros indicadores que se pueden agregar

Razones para abrir datos: Generar redes (86%) Mayor entre mujeres (93%)
y entre investigadores cuantitativos (93%) Difundir a la comunidad
científica (79%) Aumentar visibilidad (83%) Mayro entre mujeres (90%) e
investigadores cualitativos (89%) Crisis de reproducibilidad 51% cree
que hay una crisis importante de reproducibilidad, pero 31% no sabe si
la hay. Entre los investigadores cuantitativos, el 82% cree que la
crisis es importante. Entre los investigadores cualitativos el 59% no
sabe si hay una crisis de reproducibilidad El 59% cree que el 30% o
menos de las investigaciones en ciencias sociales son reproducibles; El
83% cree que menos de la mitad de las investigaciones en ciencias
sociales son reproducibles. El 58% ha intentado reproducir sus propios
resultados y el 43% los resultados de otros investigadores. Esta
práctica es mayor entre investigadores cuantitativos y de carrera
avanzada El 51% de los intentos de reproducir resultados propios se han
logrado reproducir completamente. Solo el 19% de los intentos de
reproducir resultados de otros investigadores han logrado una
reproducción completa. Un 69% ha logrado reproducciones parciales.


```{r}
# ```{r 1-cca, echo=FALSE}
# El siguiente gráfico visualiza una batería, es decir, varios tems con preguntas diferentes, pero iguales valores de respuesta. Este tipo de gráficos sigue la siguiente estructura tipo:
labels_cca <- c("Concepto Ciencia Abierta", "Acceso abierto a publicaciones", "Preregistro de hipótesis", 
                "Apertura de datos de investigación", "Investigación reproducible", "Repositorios abiertos", 
                "Software libre para análisis", "Acceso abierto a datos")
cais_v2 %>%
  # TRASPONER PARA QUE EL LA BATERÍA PASE A SER UNA VARIABLE EN SÍ MISMA
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  # RECODE PARA REDUCIR COMPLEJIDAD DE LOS VALORES
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  # CONTABILIZA EL CRUCE DE LA BATERÍA CON SUS RESPECTIVOS VALORES
  count(name, value) %>%
  # CREA NUEVA VARIABLE DE CON LA FRECUENCIA RELATIVA DE CADA VALOR RESPECTO A LA VARIABLE
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  # GGPLOT DE BARRAS 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = value, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  # ESPECIFICACIONES PARA EL TEXTO DE LAS BARRAS
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  # ESPECIFICACIONES PARA ETIQUETAS DE TÍTULOS, EJES Y LEYENDA (RELLENO)
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "") + 
  # ESPECIFICACIONES PARA POSICIÓN DE LA LEYENDA (FILL)
  theme(legend.position = 'none') +
  # ESPECIFICACIÓN DE PALETA DE COLORES
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  # AJUSTE DE LA ESCALA DEL EJE Y (PASA A PORCENTAJE)
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  # AJUSTE DE ORDEN DE LEYENDA (FILL)
  guides(fill = guide_legend(reverse = TRUE)) +
  # AJUSTE DE VISUALIZACIÓN PARA ROTAR LAS COORDENADAS
  coord_flip()
```


```{r 1-cca-sexo, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, sexo, value) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = sexo, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "Sexo/género") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 1-cca-edad, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, edad, value) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = edad, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "Grupo etario") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 1-cca-etapa, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, etapa, value) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = etapa, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "Etapa de la carrera\nacadémica") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 1-cca-grado, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, grado, value) %>%
  group_by(name, grado) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = grado, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "Grádo académico") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 1-cca-enfoque, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, enfoq, value) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  drop_na() %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = enfoq, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad", 
       caption = legend, x = "", y = "", fill = "Enfoque de investigación") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca, echo=FALSE}
labels_valor <- c("Pre-registro de hipótesis", 
                  "Disponibilizar en linea\nlos datos, materiales y\nprotocolos de análisis", 
                  "Reportar resultados aunque\nestos no sean estadísticamente\nsignificativos",
                  "Replicar y examinar los\nhallazgos publicados",
                  "Tomar medidas para que\nlas publicaciones sean\nde acceso abierto")
  
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
  ggplot(aes(x = name, y = freq, fill = factor(value, levels = c("No la conoce", "Nada o poco", "Moderadamente", "Bastante o mucho")), 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'Stack') + 
  geom_text(position = position_stack(vjust = .5), size= 2.5, color = 'white') +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-sexo, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, sexo) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = sexo, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Sexo/género") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-edad, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, edad) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = edad, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Grupo etario") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1.1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-etapa, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, etapa) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = etapa, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Etapa de la carrera\nacadémica") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1.1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-grado, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, grado) %>%
  group_by(name, grado) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = grado, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Grado académico") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-enfoque, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, enfoq) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  drop_na() %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = enfoq, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Enfoque de investigación") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 2-vca-enfoque, echo=FALSE}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, enfoq) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  drop_na() %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = enfoq, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Enfoque de investigación") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r 3-prac-sexo, echo=FALSE}
pr_comu <- cais_v2 %>%  
  select(starts_with("mod03_1_"), sexo) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Prácticas de la comunidad"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop <- cais_v2 %>% 
  select(starts_with("mod03_2_"), sexo) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Prácticas propias"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_sexo <- rbind(pr_comu, pr_prop) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Prácticas de la comunidad", "Prácticas propias"))) %>% 
  count(name, value, var, sexo) %>%
  group_by(name, var, sexo) %>%
  mutate(freq = n/sum(n))

practicas_sexo %>% 
  filter(value == "Casi siempre o siempre") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = sexo,
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Con qué frecuencia se realizan la siguientes prácticas?',  
       subtitle = "Porcentaje que responde 'Casi siempre o siempre'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(~ var)
```

```{r 4-bca-comp, echo=FALSE}

var_label_barreras <- c("Falta de conocimiento", "Falta de tiempo ", "Falta de incentivos", "Reticencias ante el plagio", "Falta de políticas")

disen <- cais_v2 %>%  
  select(starts_with("mod03_3_")) %>% pivot_longer(cols = starts_with("mod03_3_")) %>% 
  tibble(var = c(rep("Diseño transparente"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

datos <- cais_v2 %>% 
  select(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5) %>%  pivot_longer(cols = c(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5)) %>% 
  tibble(var = c(rep("Apertura de datos"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

repro <- cais_v2 %>% 
  select(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5) %>% pivot_longer(cols = c(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5)) %>% 
  tibble(var = c(rep("Investigación reproducible"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

publi <- cais_v2 %>% 
  select(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5) %>% pivot_longer(cols = c(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5)) %>% 
  tibble(var = c(rep("Publicaciones libres"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

barreras <- rbind(disen, datos, repro, publi) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nada o un poco", "Moderadamente", "Bastante o mucho"))) %>%
  mutate(var = factor(var, levels = c("Diseño transparente", "Apertura de datos", "Investigación reproducible", "Publicaciones libres"))) %>% 
  count(name, value, var) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n))

barreras %>% 
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿En qué medida considera que los siguientes factores limitan la CA?',  
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(~ var)
```